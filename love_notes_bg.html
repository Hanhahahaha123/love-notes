<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>å¯¹ä¸èµ· Â· æˆ‘çˆ±ä½  Â· ë¯¸ì•ˆí•´ ì‚¬ë‘í•´</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display",
                   "Apple SD Gothic Neo", "Noto Sans CJK KR", "PingFang SC", "Segoe UI", Roboto, Arial, sans-serif;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background-image: url('IMG_6821.jpeg');
      background-size: cover;
      background-position: center;
      filter: blur(6px) brightness(0.6);
      transform: scale(1.05);
      animation: floatBG 20s ease-in-out infinite alternate;
      z-index: 0;
    }

    @keyframes floatBG {
      0% { transform: scale(1.05) translateY(0px) translateX(0px); }
      50% { transform: scale(1.06) translateY(-10px) translateX(8px); }
      100% { transform: scale(1.05) translateY(0px) translateX(0px); }
    }

    .center {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      gap: 20px;
      justify-content: center;
      align-items: center;
      text-align: center;
      z-index: 2;
      color: white;
      text-shadow: 0 2px 8px rgba(0,0,0,0.4);
    }

    h1 {
      margin: 0;
      font-size: clamp(26px, 6vw, 48px);
      font-weight: 900;
      background: linear-gradient(90deg, #ffb2c4, #ff7a9c);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      color: transparent;
      line-height: 1.3;
    }

    .btn {
      appearance: none;
      border: none;
      padding: 14px 22px;
      border-radius: 14px;
      font-size: 16px;
      font-weight: 700;
      background: rgba(255, 71, 126, 0.95);
      color: #fff;
      box-shadow: 0 10px 24px rgba(17,17,17,.25);
      transition: transform .08s ease;
      z-index: 2;
    }
    .btn:active { transform: translateY(2px); }

    .bottom-text {
      position: fixed;
      bottom: 20px;
      left: 0; right: 0;
      text-align: center;
      color: #fff;
      font-size: 14px;
      opacity: 0;
      animation: fadeIn 3s ease 2s forwards;
      text-shadow: 0 2px 6px rgba(0,0,0,0.5);
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 0.9; }
    }

    .notes-area {
      position: absolute;
      inset: 0;
      overflow: hidden;
      z-index: 1;
    }
    .note {
      position: absolute;
      min-width: 160px;
      max-width: 260px;
      padding: 12px 14px;
      border-radius: 14px;
      color: #111;
      font-size: 14px;
      box-shadow: 0 14px 30px rgba(0,0,0,.18);
      transform: translateZ(0) rotate(var(--rot, 0deg)) scale(0);
      animation: pop .36s ease forwards;
      will-change: transform, opacity;
      line-height: 1.35;
      background: rgba(255,255,255,0.9);
    }
    .tri { display: grid; gap: 4px; }
    .zh { font-weight: 700; }
    .en, .ko { font-size: 12.5px; opacity: .95; }

    @keyframes pop {
      to { transform: rotate(var(--rot, 0deg)) scale(1); }
    }
    .fade-out { animation: fade .45s ease forwards; }
    @keyframes fade { to { opacity: 0; transform: scale(.9) rotate(var(--rot,0deg)); } }

    .heart {
      position: absolute;
      width: 14px; height: 14px;
      transform: rotate(45deg);
      background: #ff477e;
      animation: floatUp 4s ease-in infinite;
      opacity: .7;
      z-index: 0;
    }
    .heart::before, .heart::after {
      content: "";
      position: absolute;
      width: 14px; height: 14px;
      background: inherit;
      border-radius: 50%;
      top: -7px; left: 0;
    }
    .heart::after { left: -7px; top: 0; }

    @keyframes floatUp {
      from { transform: translateY(20px) rotate(45deg); opacity: .0; }
      10% { opacity: .7; }
      to   { transform: translateY(-120vh) rotate(45deg); opacity: 0; }
    }

    .gift {
      position: fixed;
      left: 50%; bottom: calc(12px + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      z-index: 1001;
      display: none;
    }
    .confetti {
      pointer-events: none;
      position: fixed;
      inset: 0;
      z-index: 2000;
    }
  </style>
</head>
<body>
  <div class="center" id="intro">
    <h1>å¯¹ä¸èµ· Â· æˆ‘çˆ±ä½ <br/>I'm sorry Â· I love you<br/>ë¯¸ì•ˆí•´ Â· ì‚¬ë‘í•´</h1>
    <button class="btn" id="startBtn">å¼€å§‹ Â· Start Â· ì‹œì‘</button>
  </div>

  <div class="notes-area" id="notes"></div>
  <canvas class="confetti" id="confetti"></canvas>
  <button class="btn gift" id="giftBtn">æ”¶ä¸‹æˆ‘çš„æŠ±æŠ± ğŸ’—</button>
  <div class="bottom-text">Click to start ğŸ’—</div>

  <script>
    const MAX_NOTES = 210;
    const CREATE_INTERVAL = 110;
    const AUTO_CLOSE_MS = 28000;

    const COLORS = ["#fff1f5", "#ffe9ec", "#fff6d1", "#e8f9ff", "#e9ffef", "#f1f0ff"];

    const triMessages = [
      ["å¯¹ä¸èµ·ï¼Œè®©ä½ å¤±æœ›äº†ã€‚","I'm sorry I let you down.","ë¯¸ì•ˆí•´, ì‹¤ë§ì‹œì¼œì„œ."],
      ["æˆ‘ä¼šæ›´ç”¨å¿ƒå¯¹å¾…ä½ ã€‚","I'll be more thoughtful with you.","ë„ˆë¥¼ ë” ì •ì„±ê» ëŒ€í• ê²Œ."],
      ["æˆ‘çˆ±ä½ ï¼Œä¸æ­¢ä»Šå¤©ã€‚","I love you, not just today.","ì˜¤ëŠ˜ë§Œì´ ì•„ë‹ˆë¼ í•­ìƒ ì‚¬ë‘í•´."],
      ["è°¢è°¢ä½ ä¸€ç›´çš„ä»˜å‡ºã€‚","Thank you for all you do.","í•­ìƒ í•´ì¤˜ì„œ ê³ ë§ˆì›Œ."],
      ["ç”Ÿæ°”ä¹Ÿè¦æŠ±æŠ±ä½ ã€‚","Even when you're mad, I want to hug you.","í™”ê°€ ë‚˜ë„ ì•ˆì•„ì¤„ë˜."],
      ["è¯·å†ç›¸ä¿¡æˆ‘ä¸€æ¬¡ã€‚","Please trust me again.","í•œ ë²ˆë§Œ ë” ë¯¿ì–´ì¤˜."],
      ["æˆ‘ä¼šåšåˆ°æˆ‘è¯´çš„ã€‚","I'll do what I promise.","ì•½ì†í•œ ê±´ ì§€í‚¬ê²Œ."],
      ["ä»¥åè®©æˆ‘æ¥å®‰æ’æƒŠå–œã€‚","Let me plan your surprises from now on.","ì•ìœ¼ë¡œ ê¹œì§ì„ ë¬¼ì€ ë‚´ê°€ ì¤€ë¹„í• ê²Œ."],
      ["ä½ çš„å¿ƒæƒ…å¾ˆé‡è¦ã€‚","Your feelings matter to me.","ë„¤ ë§ˆìŒì´ ì œì¼ ì¤‘ìš”í•´."],
      ["æˆ‘åœ¨è¿™å„¿ï¼Œæ°¸è¿œç«™ä½ è¿™è¾¹ã€‚","I'm hereâ€”always on your side.","ë‚œ ëŠ˜ ë„¤ í¸ì´ì•¼."],
      ["æƒ³ä½ ï¼Œæƒ³æŠ±ä½ ã€‚","I miss you and want to hold you.","ë³´ê³  ì‹¶ê³  ì•ˆì•„ì£¼ê³  ì‹¶ì–´."],
      ["æˆ‘ä¼šæˆä¸ºè®©ä½ å®‰å¿ƒçš„äººã€‚","I'll be someone who makes you feel at ease.","ë„ˆë¥¼ í¸ì•ˆí•˜ê²Œ í•˜ëŠ” ì‚¬ëŒì´ ë ê²Œ."],
      ["ç»™ä½ æ‰€æœ‰æ¸©æŸ”ä¸è€å¿ƒã€‚","All my gentleness and patience are yours.","ë„ˆì—ê²Œ ëª¨ë“  ë‹¤ì •ê³¼ ì¸ë‚´ë¥¼ ì¤„ê²Œ."],
      ["æˆ‘ä»¬ä¸€èµ·æŠŠé—æ†¾è¡¥ä¸Šã€‚","Let's make up for the regrets together.","ìš°ë¦¬ ê°™ì´ ì•„ì‰¬ì›€ì„ ì±„ìš°ì."],
      ["ä»Šå¤©ä¹Ÿæ˜¯çˆ±ä½ çš„æ—¥å­ã€‚","Today is another day I love you.","ì˜¤ëŠ˜ë„ ì‚¬ë‘í•˜ëŠ” ë‚ ì´ì•¼."],
      ["æˆ‘ä¼šæ›´ä¸»åŠ¨åœ°è¡¨è¾¾ã€‚","I'll express myself more often.","ë” ìì£¼ í‘œí˜„í• ê²Œ."],
      ["è°¢è°¢ä½ æ„¿æ„å‘Šè¯‰æˆ‘å¿ƒé‡Œçš„è¯ã€‚","Thank you for telling me how you feel.","ë„¤ ë§ˆìŒì„ ë§í•´ì¤˜ì„œ ê³ ë§ˆì›Œ."],
      ["æŠ±æ­‰æ²¡æœ‰æå‰å‡†å¤‡å¥½ã€‚","Sorry I didn't prepare earlier.","ë¯¸ë¦¬ ì¤€ë¹„ ëª» í•´ì„œ ë¯¸ì•ˆí•´."],
      ["è¯·æŠŠæˆ‘ç•™åœ¨ä½ èº«è¾¹ã€‚","Please keep me by your side.","ë‚´ ê³ì— ë¨¸ë¬¼ê²Œ í•´ì¤˜."],
      ["æˆ‘ä¼šå­¦ç€æˆä¸ºæ›´å¥½çš„æˆ‘ä»¬ã€‚","I'll learn to be betterâ€”for us.","ìš°ë¦¬ë¥¼ ìœ„í•´ ë” ë‚˜ì•„ì§ˆê²Œ."]
    ];

    const notesArea = document.getElementById('notes');
    const intro = document.getElementById('intro');
    const startBtn = document.getElementById('startBtn');
    const giftBtn  = document.getElementById('giftBtn');
    const confetti = document.getElementById('confetti');
    const ctx = confetti.getContext('2d');

    let timer = null;
    let heartsTimer = null;
    let count = 0;
    let stopped = false;

    function rand(min, max) { return Math.random() * (max - min) + min; }
    function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

    function makeNote() {
      if (stopped) return;
      if (count >= MAX_NOTES) return;
      const w = notesArea.clientWidth;
      const h = notesArea.clientHeight;
      const x = rand(0, Math.max(0, w - 280));
      const y = rand(0, Math.max(0, h - 140));
      const rot = rand(-9, 9);
      const note = document.createElement('div');
      note.className = 'note';
      note.style.left = x + 'px';
      note.style.top  = y + 'px';
      note.style.setProperty('--rot', rot + 'deg');
      note.style.background = COLORS[Math.floor(Math.random()*COLORS.length)];
      const [zh, en, ko] = pick(triMessages).map(s => s.replace(/\n/g, "<br/>"));
      note.innerHTML = `<div class="tri">
          <div class="zh">ğŸ“ ${zh}</div>
          <div class="en">${en}</div>
          <div class="ko">${ko}</div>
        </div>`;
      notesArea.appendChild(note);
      count++;
    }

    function makeHearts() {
      if (stopped) return;
      const w = notesArea.clientWidth;
      const h = notesArea.clientHeight;
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.style.left = rand(0, w) + 'px';
      heart.style.top  = (h - 10) + 'px';
      const sz = rand(10, 18);
      heart.style.width = heart.style.height = sz + 'px';
      heart.style.animationDuration = rand(3.5, 6) + 's';
      heart.style.opacity = rand(.3, .8);
      notesArea.appendChild(heart);
      setTimeout(() => heart.remove(), 6000);
    }

    function stopAll() {
      stopped = true;
      if (timer) clearInterval(timer);
      if (heartsTimer) clearInterval(heartsTimer);
      Array.from(document.querySelectorAll('.note')).forEach(n => n.classList.add('fade-out'));
      setTimeout(() => { notesArea.innerHTML = ''; }, 450);
      sprinkle();
      giftBtn.style.display = 'block';
    }

    const pieces = [];
    function sprinkle() {
      pieces.length = 0;
      const w = confetti.width  = window.innerWidth;
      const h = confetti.height = window.innerHeight;
      for (let i=0;i<160;i++) {
        pieces.push({
          x: Math.random()*w, y: Math.random()*-h, r: rand(4,8),
          vx: rand(-1,1), vy: rand(1.5,3.5), rot: rand(0,360),
          col: `hsl(${Math.random()*360}, 80%, 60%)`
        });
      }
      requestAnimationFrame(drawConfetti);
      setTimeout(()=>ctx.clearRect(0,0,confetti.width, confetti.height), 3000);
    }
    function drawConfetti() {
      ctx.clearRect(0,0,confetti.width, confetti.height);
      pieces.forEach(p=>{
        p.x += p.vx; p.y += p.vy; p.rot += 5;
        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot * Math.PI/180);
        ctx.fillStyle = p.col;
        ctx.fillRect(-p.r/2, -p.r/2, p.r, p.r);
        ctx.restore();
      });
      if (!stopped) requestAnimationFrame(drawConfetti);
    }

    startBtn.addEventListener('click', () => {
      intro.style.display = 'none';
      stopped = false;
      count = 0;
      timer = setInterval(makeNote, CREATE_INTERVAL);
      heartsTimer = setInterval(makeHearts, 240);
      setTimeout(stopAll, AUTO_CLOSE_MS);
    });

    giftBtn.addEventListener('click', () => {
      alert("å¯¹ä¸èµ· / I'm sorry / ë¯¸ì•ˆí•´\næˆ‘ä¼šæ›´ç”¨å¿ƒåœ°çˆ±ä½  / I'll love you more thoughtfully / ë” ì˜í• ê²Œ, ì‚¬ë‘í•´.");
    });

    window.addEventListener('resize', () => {
      confetti.width = window.innerWidth;
      confetti.height = window.innerHeight;
    }, false);
  </script>
</body>
</html>
